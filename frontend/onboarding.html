<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø·Ù„Ø¨ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª â€” NahlBooking</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #f5a623;
      --primary-light: #fef7e8;
      --primary-dark: #e8950e;
      --accent: #ffd500;
      --accent-light: #fffbeb;
      --bg: #f6f4ef;
      --white: #ffffff;
      --text: #1e293b;
      --text-secondary: #64748b;
      --border: #e2e8f0;
      --error: #dc2626;
      --error-light: #fef2f2;
      --radius: 12px;
      --shadow: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
    }

    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Cairo', sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.7;
      min-height: 100vh;
    }

    .container {
      max-width: 780px;
      margin: 0 auto;
      padding: 32px 20px 64px;
    }

    /* Header */
    .page-header {
      text-align: center;
      margin-bottom: 40px;
    }

    .page-header h1 {
      font-size: 28px;
      font-weight: 800;
      color: var(--primary);
      margin-bottom: 8px;
    }

    .page-header p {
      font-size: 15px;
      color: var(--text-secondary);
      max-width: 500px;
      margin: 0 auto;
    }

    /* Cards */
    .card {
      background: var(--white);
      border-radius: var(--radius);
      padding: 28px;
      margin-bottom: 24px;
      box-shadow: var(--shadow);
    }

    .card-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .section-num {
      width: 36px;
      height: 36px;
      background: var(--primary);
      color: var(--white);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      font-weight: 700;
      flex-shrink: 0;
    }

    .card-header h2 {
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
    }

    /* Form Elements */
    .form-group {
      margin-bottom: 18px;
    }

    .form-group:last-child {
      margin-bottom: 0;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 6px;
    }

    label .required {
      color: var(--error);
      margin-right: 2px;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="number"],
    input[type="url"],
    input[type="time"],
    textarea,
    select {
      width: 100%;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 14px;
      font-size: 15px;
      font-family: 'Cairo', sans-serif;
      color: var(--text);
      background: var(--white);
      transition: border-color 0.2s, box-shadow 0.2s;
      outline: none;
    }

    input:focus,
    textarea:focus,
    select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(245,166,35,0.1);
    }

    input.input-error,
    textarea.input-error {
      border-color: var(--error);
      box-shadow: 0 0 0 3px rgba(220,38,38,0.08);
    }

    .field-error {
      font-size: 13px;
      color: var(--error);
      margin-top: 4px;
      display: none;
    }

    .field-error.visible {
      display: block;
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    input::placeholder,
    textarea::placeholder {
      color: #94a3b8;
    }

    /* Info box */
    .info-box {
      background: var(--accent-light);
      border-right: 3px solid var(--accent);
      border-radius: 8px;
      padding: 16px 18px;
      font-size: 14px;
      color: #92400e;
      line-height: 1.8;
      white-space: pre-line;
    }

    /* Upload drop zone */
    .upload-zone {
      border: 2px dashed var(--border);
      border-radius: 10px;
      padding: 24px;
      text-align: center;
      cursor: pointer;
      transition: border-color 0.2s, background 0.2s;
      background: #fafafa;
    }
    .upload-zone:hover, .upload-zone.drag-over {
      border-color: var(--primary);
      background: var(--primary-light);
    }
    .upload-zone-icon { font-size: 32px; color: var(--text-secondary); margin-bottom: 8px; }
    .upload-zone-text { font-size: 14px; color: var(--text-secondary); margin-bottom: 4px; }
    .upload-zone-hint { font-size: 12px; color: #94a3b8; }
    .upload-zone input[type="file"] { display: none; }
    .upload-previews { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 14px; }
    .upload-preview {
      position: relative; width: 100px; height: 100px;
      border-radius: 8px; overflow: hidden;
      border: 1px solid var(--border); background: #f8f8f8;
    }
    .upload-preview img { width: 100%; height: 100%; object-fit: cover; }
    .upload-preview .remove-upload {
      position: absolute; top: 4px; right: 4px;
      width: 22px; height: 22px;
      background: rgba(220,38,38,0.9); color: white;
      border: none; border-radius: 50%; cursor: pointer;
      font-size: 14px; display: flex; align-items: center;
      justify-content: center; line-height: 1;
      opacity: 0; transition: opacity 0.2s;
    }
    .upload-preview:hover .remove-upload { opacity: 1; }
    .upload-preview.single { width: 120px; height: 120px; }
    .upload-progress {
      position: absolute; bottom: 0; left: 0; right: 0;
      height: 4px; background: rgba(0,0,0,0.1);
    }
    .upload-progress-bar {
      height: 100%; background: var(--primary);
      transition: width 0.2s; border-radius: 0 0 8px 8px;
    }
    .upload-error { font-size: 13px; color: var(--error); margin-top: 6px; }

    /* Visit times */
    .time-row {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }

    .time-row:last-child {
      margin-bottom: 0;
    }

    .time-label {
      font-weight: 600;
      font-size: 14px;
      min-width: 110px;
      flex-shrink: 0;
    }

    .time-row input[type="time"] {
      width: 140px;
      flex-shrink: 0;
    }

    .time-sep {
      color: var(--text-secondary);
      font-size: 14px;
    }

    /* Chalet cards */
    .chalets-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .chalet-card {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 22px;
      position: relative;
      background: #fafafa;
    }

    .chalet-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .chalet-num {
      font-size: 15px;
      font-weight: 700;
      color: var(--primary);
    }

    .remove-chalet {
      width: 32px;
      height: 32px;
      border: none;
      background: var(--error-light);
      color: var(--error);
      border-radius: 8px;
      cursor: pointer;
      font-size: 18px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s, transform 0.15s;
      line-height: 1;
    }

    .remove-chalet:hover {
      background: #fecaca;
      transform: scale(1.05);
    }

    /* Amenities grid */
    .amenities-label {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 10px;
      display: block;
    }

    .amenities-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }

    .amenity-check {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-size: 14px;
      color: var(--text);
      padding: 8px 10px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--white);
      transition: border-color 0.2s, background 0.2s;
      user-select: none;
    }

    .amenity-check:hover {
      border-color: var(--primary);
    }

    .amenity-check input[type="checkbox"] {
      accent-color: var(--primary);
      width: 16px;
      height: 16px;
      cursor: pointer;
      flex-shrink: 0;
    }

    .amenity-check input[type="checkbox"]:checked + span {
      color: var(--primary);
      font-weight: 600;
    }

    .add-chalet-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--primary-light);
      color: var(--primary);
      border: 1px dashed var(--primary);
      border-radius: 10px;
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 700;
      font-family: 'Cairo', sans-serif;
      cursor: pointer;
      transition: background 0.2s, transform 0.15s;
      margin-top: 4px;
    }

    .add-chalet-btn:hover {
      background: #fde9c4;
      transform: translateY(-1px);
    }

    /* Submit */
    .submit-area {
      text-align: center;
      margin-top: 16px;
    }

    .submit-btn {
      background: var(--primary);
      color: var(--white);
      border: none;
      border-radius: 10px;
      padding: 16px 56px;
      font-size: 17px;
      font-weight: 700;
      font-family: 'Cairo', sans-serif;
      cursor: pointer;
      transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
      box-shadow: 0 2px 8px rgba(245,166,35,0.25);
    }

    .submit-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
      box-shadow: 0 4px 16px rgba(245,166,35,0.3);
    }

    .submit-btn:active {
      transform: translateY(0);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .submit-error {
      color: var(--error);
      font-size: 14px;
      margin-top: 14px;
      display: none;
    }

    .submit-error.visible {
      display: block;
    }

    /* Success card */
    .success-card {
      display: none;
      text-align: center;
      padding: 48px 28px;
    }

    .success-card.visible {
      display: block;
    }

    .success-icon {
      width: 80px;
      height: 80px;
      background: var(--primary-light);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 24px;
    }

    .success-icon svg {
      width: 40px;
      height: 40px;
      color: var(--primary);
    }

    .success-card h2 {
      font-size: 22px;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 12px;
    }

    .success-card p {
      font-size: 16px;
      color: var(--text-secondary);
    }

    /* Footer */
    .page-footer {
      text-align: center;
      padding: 32px 0 16px;
      color: var(--primary);
      font-size: 14px;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 20px 14px 48px;
      }

      .card {
        padding: 20px 18px;
      }

      .form-row {
        grid-template-columns: 1fr;
        gap: 12px;
      }

      .amenities-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
      }

      .time-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }

      .time-row input[type="time"] {
        width: 100%;
      }

      .time-inputs {
        display: flex;
        gap: 10px;
        align-items: center;
        width: 100%;
      }

      .time-inputs input[type="time"] {
        flex: 1;
      }

      .page-header h1 {
        font-size: 24px;
      }

      .submit-btn {
        width: 100%;
        padding: 16px 24px;
      }

      .chalet-card {
        padding: 16px;
      }
    }

    @media (max-width: 480px) {
      .amenities-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    /* Spinner */
    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,0.3);
      border-top-color: var(--white);
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
      vertical-align: middle;
      margin-left: 8px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Fade in */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card {
      animation: fadeIn 0.4s ease-out both;
    }

    .card:nth-child(2) { animation-delay: 0.05s; }
    .card:nth-child(3) { animation-delay: 0.1s; }
    .card:nth-child(4) { animation-delay: 0.15s; }
    .card:nth-child(5) { animation-delay: 0.2s; }
    .card:nth-child(6) { animation-delay: 0.25s; }
    .card:nth-child(7) { animation-delay: 0.3s; }
    .card:nth-child(8) { animation-delay: 0.35s; }
    .card:nth-child(9) { animation-delay: 0.4s; }
    .card:nth-child(10) { animation-delay: 0.45s; }
    .card:nth-child(11) { animation-delay: 0.5s; }
    .card:nth-child(12) { animation-delay: 0.55s; }
    .card:nth-child(13) { animation-delay: 0.6s; }
  </style>
</head>
<body>

  <div class="container">

    <!-- Header -->
    <div class="page-header">
      <img src="/images/nahl-logo.png" alt="NahlBooking" style="width:64px;height:auto;margin:0 auto 12px;display:block;">
      <h1>Ø·Ù„Ø¨ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª â€” NahlBooking</h1>
      <p>Ù„ØªØ¬Ù‡ÙŠØ² Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ø®Ø§Øµ Ø¨ÙƒÙ…ØŒ Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©</p>
    </div>

    <!-- Form -->
    <form id="onboardingForm" novalidate>

      <!-- Section 1: Resort Name -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">1</div>
          <h2>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬Ø¹ / Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</h2>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label><span class="required">*</span> Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬Ø¹ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</label>
            <input type="text" id="resortNameAr" required placeholder="Ù…Ø«Ø§Ù„: Ù…Ù†ØªØ¬Ø¹ Ø§Ù„Ù†Ø®ÙŠÙ„">
            <div class="field-error" id="err-resortNameAr">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
          </div>
          <div class="form-group">
            <label><span class="required">*</span> Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬Ø¹ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</label>
            <input type="text" id="resortNameEn" required placeholder="e.g. Al Nakheel Resort" dir="ltr" style="text-align:left;">
            <div class="field-error" id="err-resortNameEn">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
          </div>
        </div>
      </div>

      <!-- Section 2: Logo -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">2</div>
          <h2>Ø§Ù„Ø´Ø¹Ø§Ø±</h2>
        </div>
        <div class="upload-zone" id="logoUploadZone" onclick="document.getElementById('logoInput').click()">
          <input type="file" id="logoInput" accept="image/png,image/jpeg,image/svg+xml,image/webp" onchange="handleLogoUpload(this)">
          <div class="upload-zone-icon">ğŸ“·</div>
          <div class="upload-zone-text">Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø§Ù„Ø´Ø¹Ø§Ø± Ù‡Ù†Ø§</div>
          <div class="upload-zone-hint">PNG, JPG, SVG â€” Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª</div>
        </div>
        <div class="upload-previews" id="logoPreviews"></div>
        <div class="upload-error" id="logoError"></div>
      </div>

      <!-- Section 3: Chalets -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">3</div>
          <h2>Ø§Ù„Ø´Ø§Ù„ÙŠÙ‡Ø§Øª / Ø§Ù„ÙˆØ­Ø¯Ø§Øª</h2>
        </div>
        <div class="chalets-container" id="chaletsContainer">
          <!-- Default chalet card inserted by JS -->
        </div>
        <button type="button" class="add-chalet-btn" onclick="addChalet()">
          <span style="font-size:20px;">+</span>
          Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ù„ÙŠÙ‡
        </button>
      </div>

      <!-- Section 4: Visit Times -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">4</div>
          <h2>Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</h2>
        </div>
        <div class="time-row">
          <span class="time-label">Ø²ÙŠØ§Ø±Ø© Ù†Ù‡Ø§Ø±ÙŠØ©</span>
          <div class="time-inputs" style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
            <span class="time-sep">Ù…Ù†</span>
            <input type="time" id="dayStart" value="08:00">
            <span class="time-sep">Ø¥Ù„Ù‰</span>
            <input type="time" id="dayEnd" value="19:00">
          </div>
        </div>
        <div class="time-row">
          <span class="time-label">Ø¥Ù‚Ø§Ù…Ø© Ù„ÙŠÙ„ÙŠØ©</span>
          <div class="time-inputs" style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
            <span class="time-sep">Ù…Ù†</span>
            <input type="time" id="nightStart" value="20:00">
            <span class="time-sep">Ø¥Ù„Ù‰</span>
            <input type="time" id="nightEnd" value="07:00">
          </div>
        </div>
      </div>

      <!-- Section 5: Pricing -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">5</div>
          <h2>Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</h2>
        </div>
        <div class="form-group">
          <label>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</label>
          <textarea id="pricing" rows="5" placeholder="Ù…Ø«Ø§Ù„:
Ø´Ø§Ù„ÙŠÙ‡ Ø§Ù„Ù†Ø®ÙŠÙ„ â€” Ù†Ù‡Ø§Ø±ÙŠØ©: 1400 Ø±.Ø³ (Ø¹Ø±Ø¨ÙˆÙ† 700) â€” Ù„ÙŠÙ„ÙŠØ©: 1800 Ø±.Ø³ (Ø¹Ø±Ø¨ÙˆÙ† 900)
Ø´Ø§Ù„ÙŠÙ‡ Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠ â€” Ù†Ù‡Ø§Ø±ÙŠØ©: 1600 Ø±.Ø³ (Ø¹Ø±Ø¨ÙˆÙ† 800) â€” Ù„ÙŠÙ„ÙŠØ©: 2000 Ø±.Ø³ (Ø¹Ø±Ø¨ÙˆÙ† 1000)"></textarea>
        </div>
      </div>

      <!-- Section 6: WhatsApp -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">6</div>
          <h2>Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø­Ø¬Ø²</h2>
        </div>
        <div class="form-group">
          <label><span class="required">*</span> Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</label>
          <input type="tel" id="whatsapp" required placeholder="+9665xxxxxxxx" dir="ltr" style="text-align:left;">
          <div class="field-error" id="err-whatsapp">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
        </div>
      </div>

      <!-- Section 7: Location -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">7</div>
          <h2>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ù†ØªØ¬Ø¹</h2>
        </div>
        <div class="form-group">
          <label>Ø§Ù„Ù…ÙˆÙ‚Ø¹</label>
          <input type="text" id="location" placeholder="Ø±Ø§Ø¨Ø· Ø®Ø±Ø§Ø¦Ø· Ù‚ÙˆÙ‚Ù„ Ø£Ùˆ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙØµÙŠÙ„ÙŠ">
        </div>
      </div>

      <!-- Section 8: Photos -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">8</div>
          <h2>ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬Ø¹</h2>
        </div>
        <div class="form-group">
          <label>ØµÙˆØ±Ø© Ø±Ø¦ÙŠØ³ÙŠØ© (Hero)</label>
          <div class="upload-zone" id="heroUploadZone" onclick="document.getElementById('heroInput').click()">
            <input type="file" id="heroInput" accept="image/png,image/jpeg,image/webp" onchange="handleHeroUpload(this)">
            <div class="upload-zone-icon">ğŸï¸</div>
            <div class="upload-zone-text">Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù‡Ù†Ø§</div>
            <div class="upload-zone-hint">PNG, JPG â€” Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª</div>
          </div>
          <div class="upload-previews" id="heroPreviews"></div>
          <div class="upload-error" id="heroError"></div>
        </div>
        <div class="form-group" style="margin-top:18px;">
          <label>ØµÙˆØ± Ø§Ù„Ù…Ø¹Ø±Ø¶ (2-10 ØµÙˆØ±)</label>
          <div class="upload-zone" id="galleryUploadZone" onclick="document.getElementById('galleryInput').click()">
            <input type="file" id="galleryInput" accept="image/png,image/jpeg,image/webp" multiple onchange="handleGalleryUpload(this)">
            <div class="upload-zone-icon">ğŸ“¸</div>
            <div class="upload-zone-text">Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ ØµÙˆØ± Ø§Ù„Ù…Ø¹Ø±Ø¶ Ù‡Ù†Ø§</div>
            <div class="upload-zone-hint">PNG, JPG â€” Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 10 ØµÙˆØ±ØŒ 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª Ù„ÙƒÙ„ ØµÙˆØ±Ø©</div>
          </div>
          <div class="upload-previews" id="galleryPreviews"></div>
          <div class="upload-error" id="galleryError"></div>
        </div>
      </div>

      <!-- Section 9: Cancellation -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">9</div>
          <h2>Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ù„ØºØ§Ø¡</h2>
        </div>
        <div class="form-group">
          <label>Ø§Ù„Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ Ù‚Ø¨Ù„ ÙƒÙ… Ø³Ø§Ø¹Ø© Ù…Ù† Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø©ØŸ</label>
          <input type="number" id="cancellation" value="48" min="0" style="max-width:180px;">
        </div>
      </div>

      <!-- Section 10: Domain -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">10</div>
          <h2>Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†</h2>
        </div>
        <div class="form-group">
          <label>Ø§Ø³Ù… Ø§Ù„Ù†Ø·Ø§Ù‚</label>
          <input type="text" id="domain" placeholder="example.com (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" dir="ltr" style="text-align:left;">
        </div>
      </div>

      <!-- Section 11: Admin Info -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">11</div>
          <h2>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h2>
        </div>
        <div class="form-group">
          <label><span class="required">*</span> Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
          <input type="text" id="adminName" required placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
          <div class="field-error" id="err-adminName">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label><span class="required">*</span> Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input type="email" id="adminEmail" required placeholder="email@example.com" dir="ltr" style="text-align:left;">
            <div class="field-error" id="err-adminEmail">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ§Ù„Ø­</div>
          </div>
          <div class="form-group">
            <label><span class="required">*</span> Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
            <input type="tel" id="adminPhone" required placeholder="+9665xxxxxxxx" dir="ltr" style="text-align:left;">
            <div class="field-error" id="err-adminPhone">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
          </div>
        </div>
      </div>

      <!-- Section 12: Notes -->
      <div class="card">
        <div class="card-header">
          <div class="section-num">12</div>
          <h2>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</h2>
        </div>
        <div class="form-group">
          <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
          <textarea id="notes" rows="4" placeholder="Ø£ÙŠ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø£Ùˆ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ØªÙˆØ¯ÙˆÙ† Ù…Ø´Ø§Ø±ÙƒØªÙ‡Ø§..."></textarea>
        </div>
      </div>

      <!-- Submit -->
      <div class="card submit-area">
        <button type="button" class="submit-btn" id="submitBtn" onclick="submitForm()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
        <div class="submit-error" id="submitError"></div>
      </div>

    </form>

    <!-- Success -->
    <div class="card success-card" id="successCard">
      <div class="success-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 6L9 17l-5-5"/>
        </svg>
      </div>
      <h2>ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨ÙƒÙ… Ø¨Ù†Ø¬Ø§Ø­!</h2>
      <p>Ø³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹ÙƒÙ… ÙØ±ÙŠÙ‚ Ù†Ø­Ù„ Ù‚Ø±ÙŠØ¨Ø§.</p>
    </div>

    <!-- Footer -->
    <div class="page-footer">
      Ø´ÙƒØ±Ø§ Ù„ØªØ¹Ø§ÙˆÙ†ÙƒÙ… â€” ÙØ±ÙŠÙ‚ Ù†Ø­Ù„ NahlBooking
    </div>

  </div>

  <script>
    /* â”€â”€ Amenities definition â”€â”€ */
    const AMENITIES = [
      { key: 'wifi',       label: 'ÙˆØ§ÙŠ ÙØ§ÙŠ' },
      { key: 'pool',       label: 'Ù…Ø³Ø¨Ø­' },
      { key: 'bbq',        label: 'Ø´ÙˆØ§Ø¡' },
      { key: 'parking',    label: 'Ù…ÙˆØ§Ù‚Ù Ø³ÙŠØ§Ø±Ø§Øª' },
      { key: 'playground', label: 'Ø£Ù„Ø¹Ø§Ø¨ Ø£Ø·ÙØ§Ù„' },
      { key: 'jacuzzi',    label: 'Ø¬Ø§ÙƒÙˆØ²ÙŠ' },
      { key: 'kitchen',    label: 'Ù…Ø·Ø¨Ø®' },
      { key: 'ac',         label: 'ØªÙƒÙŠÙŠÙ' },
    ];

    let chaletCounter = 0;

    /* â”€â”€ Cloudinary Upload â”€â”€ */
    var CLOUD_NAME = '';
    var UPLOAD_PRESET = '';

    async function loadConfig() {
      try {
        var res = await fetch('/api/config');
        var data = await res.json();
        if (data.ok) {
          CLOUD_NAME = data.data.cloudinaryCloudName;
          UPLOAD_PRESET = data.data.cloudinaryUploadPreset;
        }
      } catch (e) { console.warn('Config load failed:', e); }
    }
    loadConfig();

    var uploadState = { logoUrl: null, heroImageUrl: null, galleryUrls: [], chaletImageUrls: {} };
    var activeUploads = 0;

    function uploadToCloudinaryWithProgress(file, folder, previewEl) {
      return new Promise(function(resolve, reject) {
        if (!CLOUD_NAME || !UPLOAD_PRESET) { reject(new Error('Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±ÙØ¹')); return; }
        if (file.size > 10 * 1024 * 1024) { reject(new Error('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙŠØªØ¬Ø§ÙˆØ² 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª')); return; }
        var allowed = ['image/png','image/jpeg','image/jpg','image/webp','image/svg+xml'];
        if (!allowed.includes(file.type)) { reject(new Error('ØµÙŠØºØ© Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø©')); return; }
        activeUploads++;
        var fd = new FormData();
        fd.append('file', file);
        fd.append('upload_preset', UPLOAD_PRESET);
        var resortName = (document.getElementById('resortNameEn').value.trim() || 'unnamed').replace(/[^a-zA-Z0-9_-]/g, '_').substring(0, 40);
        fd.append('folder', 'onboarding/' + resortName + '/' + folder);
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://api.cloudinary.com/v1_1/' + CLOUD_NAME + '/image/upload');
        xhr.upload.onprogress = function(e) {
          if (e.lengthComputable) {
            var bar = previewEl.querySelector('.upload-progress-bar');
            if (bar) bar.style.width = Math.round((e.loaded / e.total) * 100) + '%';
          }
        };
        xhr.onload = function() {
          activeUploads--;
          if (xhr.status === 200) {
            var d = JSON.parse(xhr.responseText);
            resolve({ url: d.secure_url, publicId: d.public_id });
          } else { reject(new Error('ÙØ´Ù„ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©')); }
        };
        xhr.onerror = function() { activeUploads--; reject(new Error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„')); };
        xhr.send(fd);
      });
    }

    function createProgressPreview() {
      var div = document.createElement('div');
      div.className = 'upload-preview';
      div.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#94a3b8;font-size:12px;">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...</div>' +
        '<div class="upload-progress"><div class="upload-progress-bar" style="width:0%"></div></div>';
      return div;
    }

    function createPreviewElement(url, onRemove) {
      var div = document.createElement('div');
      div.className = 'upload-preview';
      div.innerHTML = '<img src="' + url + '" alt="">' +
        '<button type="button" class="remove-upload" title="Ø­Ø°Ù">&times;</button>';
      div.querySelector('.remove-upload').addEventListener('click', function() { div.remove(); if (onRemove) onRemove(); });
      return div;
    }

    async function handleLogoUpload(input) {
      var file = input.files[0]; if (!file) return; input.value = '';
      var err = document.getElementById('logoError'); err.textContent = '';
      var prev = document.getElementById('logoPreviews'); prev.innerHTML = '';
      var p = createProgressPreview(); p.classList.add('single'); prev.appendChild(p);
      try {
        var r = await uploadToCloudinaryWithProgress(file, 'logos', p);
        uploadState.logoUrl = r.url; prev.innerHTML = '';
        var el = createPreviewElement(r.url, function() { uploadState.logoUrl = null; });
        el.classList.add('single'); prev.appendChild(el);
      } catch (e) { prev.innerHTML = ''; err.textContent = e.message; }
    }

    async function handleHeroUpload(input) {
      var file = input.files[0]; if (!file) return; input.value = '';
      var err = document.getElementById('heroError'); err.textContent = '';
      var prev = document.getElementById('heroPreviews'); prev.innerHTML = '';
      var p = createProgressPreview(); prev.appendChild(p);
      try {
        var r = await uploadToCloudinaryWithProgress(file, 'hero', p);
        uploadState.heroImageUrl = r.url; prev.innerHTML = '';
        prev.appendChild(createPreviewElement(r.url, function() { uploadState.heroImageUrl = null; }));
      } catch (e) { prev.innerHTML = ''; err.textContent = e.message; }
    }

    async function handleGalleryUpload(input) {
      var files = Array.from(input.files); if (!files.length) return; input.value = '';
      var err = document.getElementById('galleryError'); err.textContent = '';
      var prev = document.getElementById('galleryPreviews');
      if (uploadState.galleryUrls.length + files.length > 10) { err.textContent = 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 10 ØµÙˆØ±'; return; }
      files.forEach(function(file) {
        var p = createProgressPreview(); prev.appendChild(p);
        uploadToCloudinaryWithProgress(file, 'gallery', p).then(function(r) {
          uploadState.galleryUrls.push(r.url); p.remove();
          prev.appendChild(createPreviewElement(r.url, function() {
            var i = uploadState.galleryUrls.indexOf(r.url);
            if (i > -1) uploadState.galleryUrls.splice(i, 1);
          }));
        }).catch(function(e) { p.remove(); err.textContent = e.message; });
      });
    }

    async function handleChaletImageUpload(input, chaletNum) {
      var file = input.files[0]; if (!file) return; input.value = '';
      var card = input.closest('.chalet-card');
      var err = card.querySelector('.chalet-image-error'); err.textContent = '';
      var prev = card.querySelector('.chalet-image-previews'); prev.innerHTML = '';
      var p = createProgressPreview(); prev.appendChild(p);
      try {
        var r = await uploadToCloudinaryWithProgress(file, 'chalets', p);
        uploadState.chaletImageUrls[chaletNum] = r.url; prev.innerHTML = '';
        prev.appendChild(createPreviewElement(r.url, function() { delete uploadState.chaletImageUrls[chaletNum]; }));
      } catch (e) { prev.innerHTML = ''; err.textContent = e.message; }
    }

    /* â”€â”€ Build a chalet card HTML â”€â”€ */
    function buildChaletHTML(num) {
      const amenitiesHTML = AMENITIES.map(a =>
        '<label class="amenity-check">' +
          '<input type="checkbox" value="' + a.key + '">' +
          '<span>' + a.label + '</span>' +
        '</label>'
      ).join('');

      return '' +
        '<div class="chalet-card" data-chalet-id="' + num + '">' +
          '<div class="chalet-card-header">' +
            '<span class="chalet-num">Ø´Ø§Ù„ÙŠÙ‡ #' + num + '</span>' +
            '<button type="button" class="remove-chalet" onclick="removeChalet(this)" title="Ø­Ø°Ù">&times;</button>' +
          '</div>' +
          '<div class="form-row">' +
            '<div class="form-group">' +
              '<label>Ø§Ø³Ù… Ø§Ù„Ø´Ø§Ù„ÙŠÙ‡ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</label>' +
              '<input type="text" class="chalet-name-ar" placeholder="Ù…Ø«Ø§Ù„: Ø´Ø§Ù„ÙŠÙ‡ Ø§Ù„Ù†Ø®ÙŠÙ„">' +
            '</div>' +
            '<div class="form-group">' +
              '<label>Ø§Ø³Ù… Ø§Ù„Ø´Ø§Ù„ÙŠÙ‡ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</label>' +
              '<input type="text" class="chalet-name-en" placeholder="e.g. Palm Chalet" dir="ltr" style="text-align:left;">' +
            '</div>' +
          '</div>' +
          '<div class="form-group">' +
            '<label>Ø¹Ø¯Ø¯ Ø§Ù„Ø¶ÙŠÙˆÙ Ø§Ù„Ø£Ù‚ØµÙ‰</label>' +
            '<input type="number" class="chalet-max-guests" min="1" placeholder="10" style="max-width:180px;">' +
          '</div>' +
          '<div class="form-group">' +
            '<label>ÙˆØµÙ Ù…Ø®ØªØµØ±</label>' +
            '<textarea class="chalet-description" rows="2" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ± Ø¹Ù† Ø§Ù„Ø´Ø§Ù„ÙŠÙ‡..."></textarea>' +
          '</div>' +
          '<div class="form-group">' +
            '<label>ØµÙˆØ±Ø© Ø§Ù„Ø´Ø§Ù„ÙŠÙ‡</label>' +
            '<div class="upload-zone chalet-upload-zone" onclick="this.querySelector(\'input\').click()">' +
              '<input type="file" accept="image/png,image/jpeg,image/webp" onchange="handleChaletImageUpload(this, ' + num + ')">' +
              '<div class="upload-zone-icon">ğŸ </div>' +
              '<div class="upload-zone-text">Ø§Ø¶ØºØ· Ù„Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© Ø§Ù„Ø´Ø§Ù„ÙŠÙ‡</div>' +
              '<div class="upload-zone-hint">PNG, JPG â€” Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª</div>' +
            '</div>' +
            '<div class="upload-previews chalet-image-previews"></div>' +
            '<div class="upload-error chalet-image-error"></div>' +
          '</div>' +
          '<span class="amenities-label">Ø§Ù„Ù…Ø±Ø§ÙÙ‚ ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª</span>' +
          '<div class="amenities-grid">' +
            amenitiesHTML +
          '</div>' +
        '</div>';
    }

    /* â”€â”€ Add chalet â”€â”€ */
    function addChalet() {
      chaletCounter++;
      var container = document.getElementById('chaletsContainer');
      var wrapper = document.createElement('div');
      wrapper.innerHTML = buildChaletHTML(chaletCounter);
      var card = wrapper.firstChild;
      container.appendChild(card);
      // Animate in
      card.style.animation = 'fadeIn 0.3s ease-out both';
      // Set up drag-and-drop for chalet upload zone
      var chaletZone = card.querySelector('.chalet-upload-zone');
      if (chaletZone) {
        chaletZone.addEventListener('dragover', function(e) { e.preventDefault(); chaletZone.classList.add('drag-over'); });
        chaletZone.addEventListener('dragleave', function() { chaletZone.classList.remove('drag-over'); });
        chaletZone.addEventListener('drop', function(e) {
          e.preventDefault(); chaletZone.classList.remove('drag-over');
          var inp = chaletZone.querySelector('input[type="file"]');
          if (e.dataTransfer.files.length) { inp.files = e.dataTransfer.files; inp.dispatchEvent(new Event('change')); }
        });
      }
      updateRemoveButtons();
    }

    /* â”€â”€ Remove chalet â”€â”€ */
    function removeChalet(btn) {
      var cards = document.querySelectorAll('.chalet-card');
      if (cards.length <= 1) return;
      var card = btn.closest('.chalet-card');
      card.style.opacity = '0';
      card.style.transform = 'translateY(-8px)';
      card.style.transition = 'opacity 0.2s, transform 0.2s';
      setTimeout(function() {
        card.remove();
        renumberChalets();
        updateRemoveButtons();
      }, 200);
    }

    /* â”€â”€ Renumber chalets â”€â”€ */
    function renumberChalets() {
      var cards = document.querySelectorAll('.chalet-card');
      cards.forEach(function(card, i) {
        card.querySelector('.chalet-num').textContent = 'Ø´Ø§Ù„ÙŠÙ‡ #' + (i + 1);
      });
    }

    /* â”€â”€ Show/hide remove button â”€â”€ */
    function updateRemoveButtons() {
      var cards = document.querySelectorAll('.chalet-card');
      cards.forEach(function(card) {
        var btn = card.querySelector('.remove-chalet');
        btn.style.display = cards.length <= 1 ? 'none' : 'flex';
      });
    }

    /* â”€â”€ Collect chalets data â”€â”€ */
    function collectChalets() {
      var chalets = [];
      var cards = document.querySelectorAll('.chalet-card');
      cards.forEach(function(card) {
        var nameAr = card.querySelector('.chalet-name-ar').value.trim();
        var nameEn = card.querySelector('.chalet-name-en').value.trim();
        var maxGuests = parseInt(card.querySelector('.chalet-max-guests').value) || 1;
        var description = card.querySelector('.chalet-description').value.trim();
        var amenities = [];
        card.querySelectorAll('.amenities-grid input[type="checkbox"]:checked').forEach(function(cb) {
          amenities.push(cb.value);
        });
        var chaletId = card.getAttribute('data-chalet-id');
        var imageUrl = uploadState.chaletImageUrls[chaletId] || undefined;
        chalets.push({
          nameAr: nameAr,
          nameEn: nameEn,
          maxGuests: maxGuests,
          description: description,
          amenities: amenities,
          imageUrl: imageUrl,
        });
      });
      return chalets;
    }

    /* â”€â”€ Validation helpers â”€â”€ */
    function clearErrors() {
      document.querySelectorAll('.input-error').forEach(function(el) {
        el.classList.remove('input-error');
      });
      document.querySelectorAll('.field-error').forEach(function(el) {
        el.classList.remove('visible');
      });
    }

    function showError(inputId, errorId) {
      var input = document.getElementById(inputId);
      var error = document.getElementById(errorId);
      if (input) input.classList.add('input-error');
      if (error) error.classList.add('visible');
    }

    function isValidEmail(email) {
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    /* â”€â”€ Submit form â”€â”€ */
    async function submitForm() {
      clearErrors();

      var submitError = document.getElementById('submitError');
      submitError.classList.remove('visible');
      submitError.textContent = '';

      if (activeUploads > 0) {
        submitError.textContent = 'ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ Ø§ÙƒØªÙ…Ø§Ù„ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±';
        submitError.classList.add('visible');
        return;
      }

      var valid = true;

      // Required fields validation
      var resortNameAr = document.getElementById('resortNameAr').value.trim();
      if (!resortNameAr) { showError('resortNameAr', 'err-resortNameAr'); valid = false; }

      var resortNameEn = document.getElementById('resortNameEn').value.trim();
      if (!resortNameEn) { showError('resortNameEn', 'err-resortNameEn'); valid = false; }

      var whatsapp = document.getElementById('whatsapp').value.trim();
      if (!whatsapp) { showError('whatsapp', 'err-whatsapp'); valid = false; }

      var adminName = document.getElementById('adminName').value.trim();
      if (!adminName) { showError('adminName', 'err-adminName'); valid = false; }

      var adminEmail = document.getElementById('adminEmail').value.trim();
      if (!adminEmail || !isValidEmail(adminEmail)) { showError('adminEmail', 'err-adminEmail'); valid = false; }

      var adminPhone = document.getElementById('adminPhone').value.trim();
      if (!adminPhone) { showError('adminPhone', 'err-adminPhone'); valid = false; }

      if (!valid) {
        // Scroll to first error
        var firstErr = document.querySelector('.input-error');
        if (firstErr) {
          firstErr.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        return;
      }

      var payload = {
        resortNameAr: resortNameAr,
        resortNameEn: resortNameEn,
        chalets: collectChalets(),
        dayVisitStart: document.getElementById('dayStart').value,
        dayVisitEnd: document.getElementById('dayEnd').value,
        overnightStart: document.getElementById('nightStart').value,
        overnightEnd: document.getElementById('nightEnd').value,
        pricing: document.getElementById('pricing').value.trim(),
        whatsappNumber: whatsapp,
        location: document.getElementById('location').value.trim(),
        cancellationHrs: parseInt(document.getElementById('cancellation').value) || 48,
        domain: document.getElementById('domain').value.trim(),
        adminName: adminName,
        adminEmail: adminEmail,
        adminPhone: adminPhone,
        notes: document.getElementById('notes').value.trim(),
        logoUrl: uploadState.logoUrl || undefined,
        heroImageUrl: uploadState.heroImageUrl || undefined,
        galleryUrls: uploadState.galleryUrls.length > 0 ? uploadState.galleryUrls : undefined,
      };

      var submitBtn = document.getElementById('submitBtn');
      var originalText = submitBtn.textContent;
      submitBtn.disabled = true;
      submitBtn.innerHTML = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...<span class="spinner"></span>';

      try {
        var response = await fetch('/api/onboarding', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
        });

        if (!response.ok) {
          var errData = {};
          try { errData = await response.json(); } catch(e) {}
          var errMsg = errData.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨';
          if (errData.errors && errData.errors.length) {
            errMsg += ':\n' + errData.errors.map(function(e) { return e.field + ': ' + e.message; }).join('\n');
          }
          throw new Error(errMsg);
        }

        // Success
        document.getElementById('onboardingForm').style.display = 'none';
        var successCard = document.getElementById('successCard');
        successCard.classList.add('visible');
        successCard.style.animation = 'fadeIn 0.5s ease-out both';
        window.scrollTo({ top: 0, behavior: 'smooth' });

      } catch (err) {
        submitError.textContent = err.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.';
        submitError.classList.add('visible');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
      }
    }

    /* â”€â”€ Clear error on input â”€â”€ */
    document.addEventListener('input', function(e) {
      var input = e.target;
      if (input.classList.contains('input-error')) {
        input.classList.remove('input-error');
        var errEl = input.parentElement.querySelector('.field-error');
        if (errEl) errEl.classList.remove('visible');
      }
    });

    /* â”€â”€ Init: add first chalet â”€â”€ */
    addChalet();

    /* â”€â”€ Drag and drop for static zones â”€â”€ */
    ['logoUploadZone', 'heroUploadZone', 'galleryUploadZone'].forEach(function(id) {
      var zone = document.getElementById(id);
      if (!zone) return;
      zone.addEventListener('dragover', function(e) { e.preventDefault(); zone.classList.add('drag-over'); });
      zone.addEventListener('dragleave', function() { zone.classList.remove('drag-over'); });
      zone.addEventListener('drop', function(e) {
        e.preventDefault(); zone.classList.remove('drag-over');
        var inp = zone.querySelector('input[type="file"]');
        if (e.dataTransfer.files.length) { inp.files = e.dataTransfer.files; inp.dispatchEvent(new Event('change')); }
      });
    });
  </script>

</body>
</html>
